- name: install kube-prometheus setup-manifests
  kubernetes.core.k8s:
    state: present
    kubeconfig: "{{ rke2_kubeconf_host_path }}{{ rke2_download_kubeconf_file_name }}"
    src: "{{ k8s_setup_monitoring_item }}"
  loop: "{{ lookup('fileglob', 'manifests_autogenerated/setup/0namespace*.yaml', wantlist=true)
    + lookup('fileglob', 'manifests_autogenerated/setup/prometheus*.yaml', wantlist=true) }}"
  loop_control:
    loop_var: k8s_setup_monitoring_item

- name: install kube-prometheus manifests
  kubernetes.core.k8s:
    state: present
    kubeconfig: "{{ rke2_kubeconf_host_path }}{{ rke2_download_kubeconf_file_name }}"
    src: "{{ k8s_setup_monitoring_item }}"
  loop: "{{ lookup('fileglob', 'manifests_autogenerated/*.yaml', wantlist=true) }}"
  loop_control:
    loop_var: k8s_setup_monitoring_item
